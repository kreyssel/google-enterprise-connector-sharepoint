<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_05) on Mon Jun 22 16:46:37 IST 2009 -->
<TITLE>
GlobalState (Google Enterprise Connector for Microsoft SharePoint 2003,2007 (Version 2.0.0_Build9))
</TITLE>

<META NAME="keywords" CONTENT="com.google.enterprise.connector.sharepoint.state.GlobalState class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="GlobalState (Google Enterprise Connector for Microsoft SharePoint 2003,2007 (Version 2.0.0_Build9))";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/ListState.html" title="class in com.google.enterprise.connector.sharepoint.state"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../../index.html?com/google/enterprise/connector/sharepoint/state/GlobalState.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="GlobalState.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.google.enterprise.connector.sharepoint.state</FONT>
<BR>
Class GlobalState</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../../../resources/inherit.gif" ALT="extended by "><B>com.google.enterprise.connector.sharepoint.state.GlobalState</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>GlobalState</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
Represents the state of a site. Can be persisted to XML and
 loaded again from the XML. This would normally be done if the
 connector wants to be restartable.
 The state of SharePoint traversal is composed almost entirely of the 
 state of other classes, which must implement the StatefulObject interface. 
 As of May 2007, there is only one StatefulObject -- ListState.

 Classes:
     GlobalState.
 related classes:
     StatefulObject (interface)
     ListState (implements StatefulObject)
<P>

<P>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#bFullReCrawl">bFullReCrawl</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#currentWeb">currentWeb</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The "currentWeb" object for WebState.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.SortedSet&lt;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#dateMap">dateMap</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To keep track of WebStates, we keep two data structures: a TreeSet relying
 on the insertion time property of a StatefulObject, and a HashMap on the
 primary key of the object (id for Webs).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#feedType">feedType</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.Map&lt;java.lang.String,<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#keyMap">keyMap</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#lastCrawledListID">lastCrawledListID</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#lastCrawledWebID">lastCrawledWebID</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private static&nbsp;java.util.logging.Logger</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#LOGGER">LOGGER</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#recrawling">recrawling</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#workDir">workDir</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#GlobalState(java.lang.String, java.lang.String)">GlobalState</A></B>(java.lang.String&nbsp;inWorkDir,
            java.lang.String&nbsp;inFeedType)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#endRecrawl(com.google.enterprise.connector.sharepoint.client.SharepointClientContext)">endRecrawl</A></B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client">SharepointClientContext</A>&nbsp;spContext)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Signals that the recrawl cycle is over, and GlobalState may now
 delete any ListState which did not appear in a 
 updateList() call since the startRecrawl() call.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#forgetState(java.lang.String)">forgetState</A></B>(java.lang.String&nbsp;workDir)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Delete our state file.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.SortedSet</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#getAllWebStateSet()">getAllWebStateSet</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.Iterator</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#getCircularIterator()">getCircularIterator</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get dateMap iterator beginning at the current ListState and wrapping 
 around to finish just before the current.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#getCurrentWeb()">getCurrentWeb</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the current ListState.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#getFeedType()">getFeedType</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.Iterator</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#getIterator()">getIterator</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get an iterator which returns the objects in increasing order of their
 lastModified dates.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#getLastCrawledListID()">getLastCrawledListID</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#getLastCrawledWebID()">getLastCrawledWebID</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.io.File</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#getStateFileLocation()">getStateFileLocation</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return the location for our state file.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#getStateXML()">getStateXML</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return an XML string representing the current state.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#isBFullReCrawl()">isBFullReCrawl</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#loadState()">loadState</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Load persistent state from our XML state.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#loadStateXML(java.io.File)">loadStateXML</A></B>(java.io.File&nbsp;fileState)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Load from XML.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/ListState.html" title="class in com.google.enterprise.connector.sharepoint.state">ListState</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#lookupList(java.lang.String, java.lang.String)">lookupList</A></B>(java.lang.String&nbsp;webid,
           java.lang.String&nbsp;listid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lookup a ListState by its key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#lookupWeb(java.lang.String, com.google.enterprise.connector.sharepoint.client.SharepointClientContext)">lookupWeb</A></B>(java.lang.String&nbsp;key,
          <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client">SharepointClientContext</A>&nbsp;sharepointClientContext)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lookup a WebState by its key.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#makeWebState(com.google.enterprise.connector.sharepoint.client.SharepointClientContext, java.lang.String)">makeWebState</A></B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client">SharepointClientContext</A>&nbsp;spContext,
             java.lang.String&nbsp;key)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Factory method for WebState.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#removeWebStateFromKeyMap(com.google.enterprise.connector.sharepoint.state.WebState)">removeWebStateFromKeyMap</A></B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&nbsp;inWebs)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#saveState()">saveState</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates an XML representation of our state, and saves it, using the
 PrefsStore mechanism.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#setBFullReCrawl(boolean)">setBFullReCrawl</A></B>(boolean&nbsp;fullReCrawl)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#setCurrentWeb(com.google.enterprise.connector.sharepoint.state.WebState)">setCurrentWeb</A></B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&nbsp;inCurrentWeb)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the given List as "current"
 This will be remembered in the XML state.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#setLastCrawledListID(java.lang.String)">setLastCrawledListID</A></B>(java.lang.String&nbsp;inLastCrawledListState)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#setLastCrawledWebID(java.lang.String)">setLastCrawledWebID</A></B>(java.lang.String&nbsp;inLastCrawledWebID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#startRecrawl()">startRecrawl</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Signal that a complete "recrawl" cycle is beginning, where all lists
 are being fetched from SharePoint.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html#updateList(com.google.enterprise.connector.sharepoint.state.WebState)">updateList</A></B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&nbsp;state)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For a single StatefulObject, update the two
 data structures (url -> obj and time -> obj) and mark
 it "Existing" (if between startRecrawl() and endRecrawl()).</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="LOGGER"><!-- --></A><H3>
LOGGER</H3>
<PRE>
private static final java.util.logging.Logger <B>LOGGER</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="recrawling"><!-- --></A><H3>
recrawling</H3>
<PRE>
private boolean <B>recrawling</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="workDir"><!-- --></A><H3>
workDir</H3>
<PRE>
private java.lang.String <B>workDir</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="feedType"><!-- --></A><H3>
feedType</H3>
<PRE>
private java.lang.String <B>feedType</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="dateMap"><!-- --></A><H3>
dateMap</H3>
<PRE>
protected java.util.SortedSet&lt;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&gt; <B>dateMap</B></PRE>
<DL>
<DD>To keep track of WebStates, we keep two data structures: a TreeSet relying
 on the insertion time property of a StatefulObject, and a HashMap on the
 primary key of the object (id for Webs).  The StatefulObject interface
 is often used to reduce our dependency on peculiarities of WebState. (At
 one time, it was thought that there would be other instances of 
 StatefulObject, and in the future there could be again)
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="keyMap"><!-- --></A><H3>
keyMap</H3>
<PRE>
protected java.util.Map&lt;java.lang.String,<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&gt; <B>keyMap</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="currentWeb"><!-- --></A><H3>
currentWeb</H3>
<PRE>
protected <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A> <B>currentWeb</B></PRE>
<DL>
<DD>The "currentWeb" object for WebState. The current object may be null.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="lastCrawledWebID"><!-- --></A><H3>
lastCrawledWebID</H3>
<PRE>
private java.lang.String <B>lastCrawledWebID</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="lastCrawledListID"><!-- --></A><H3>
lastCrawledListID</H3>
<PRE>
private java.lang.String <B>lastCrawledListID</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="bFullReCrawl"><!-- --></A><H3>
bFullReCrawl</H3>
<PRE>
private boolean <B>bFullReCrawl</B></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="GlobalState(java.lang.String, java.lang.String)"><!-- --></A><H3>
GlobalState</H3>
<PRE>
public <B>GlobalState</B>(java.lang.String&nbsp;inWorkDir,
                   java.lang.String&nbsp;inFeedType)</PRE>
<DL>
<DD>Constructor.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>inWorkDir</CODE> - the googleConnectorWorkDir (which we ask for
     in connectorInstance.xml).  The state file is saved in this
     directory.  If workDir is null, the current working directory is
     used instead.  (In either case, the location of the file is
     saved in the system preferences, so that environmental changes don't
     make us lose the file.)</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="forgetState(java.lang.String)"><!-- --></A><H3>
forgetState</H3>
<PRE>
public static void <B>forgetState</B>(java.lang.String&nbsp;workDir)</PRE>
<DL>
<DD>Delete our state file. This is for debugging purposes, so that unit
 tests can start from a clean state.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>workDir</CODE> - the googleConnectorWorkDir argument to the constructor</DL>
</DD>
</DL>
<HR>

<A NAME="makeWebState(com.google.enterprise.connector.sharepoint.client.SharepointClientContext, java.lang.String)"><!-- --></A><H3>
makeWebState</H3>
<PRE>
public <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A> <B>makeWebState</B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client">SharepointClientContext</A>&nbsp;spContext,
                             java.lang.String&nbsp;key)
                      throws <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></PRE>
<DL>
<DD>Factory method for WebState.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>spContext</CODE> - The connector context being used<DD><CODE>key</CODE> - the "primary key" of the object. This would probably be the WebID
<DT><B>Returns:</B><DD>new <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state"><CODE>WebState</CODE></A> which is already indexed in GlobalState's dateMap and keyMap
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="startRecrawl()"><!-- --></A><H3>
startRecrawl</H3>
<PRE>
public void <B>startRecrawl</B>()</PRE>
<DL>
<DD>Signal that a complete "recrawl" cycle is beginning, where all lists
 are being fetched from SharePoint.  This GlobalState will
 keep track of which objects are still present.  At the endRecrawl()
 call, objects no longer existing may be removed.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="endRecrawl(com.google.enterprise.connector.sharepoint.client.SharepointClientContext)"><!-- --></A><H3>
endRecrawl</H3>
<PRE>
public void <B>endRecrawl</B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client">SharepointClientContext</A>&nbsp;spContext)</PRE>
<DL>
<DD>Signals that the recrawl cycle is over, and GlobalState may now
 delete any ListState which did not appear in a 
 updateList() call since the startRecrawl() call.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="removeWebStateFromKeyMap(com.google.enterprise.connector.sharepoint.state.WebState)"><!-- --></A><H3>
removeWebStateFromKeyMap</H3>
<PRE>
public void <B>removeWebStateFromKeyMap</B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&nbsp;inWebs)</PRE>
<DL>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>inWebs</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="getIterator()"><!-- --></A><H3>
getIterator</H3>
<PRE>
public java.util.Iterator <B>getIterator</B>()</PRE>
<DL>
<DD>Get an iterator which returns the objects in increasing order of their
 lastModified dates.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Iterator on the objects by lastModified time</DL>
</DD>
</DL>
<HR>

<A NAME="getCircularIterator()"><!-- --></A><H3>
getCircularIterator</H3>
<PRE>
public java.util.Iterator <B>getCircularIterator</B>()</PRE>
<DL>
<DD>Get dateMap iterator beginning at the current ListState and wrapping 
 around to finish just before the current.  If there is no current,
 you just get an ordinary iterator.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Iterator which begins at getCurrentList() and wraps around the end</DL>
</DD>
</DL>
<HR>

<A NAME="lookupList(java.lang.String, java.lang.String)"><!-- --></A><H3>
lookupList</H3>
<PRE>
public <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/ListState.html" title="class in com.google.enterprise.connector.sharepoint.state">ListState</A> <B>lookupList</B>(java.lang.String&nbsp;webid,
                            java.lang.String&nbsp;listid)</PRE>
<DL>
<DD>Lookup a ListState by its key.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>webid</CODE> - web state in which the list is to be searched<DD><CODE>listid</CODE> - the list GUID to be searched
<DT><B>Returns:</B><DD>object handle, or null if none found</DL>
</DD>
</DL>
<HR>

<A NAME="lookupWeb(java.lang.String, com.google.enterprise.connector.sharepoint.client.SharepointClientContext)"><!-- --></A><H3>
lookupWeb</H3>
<PRE>
public <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A> <B>lookupWeb</B>(java.lang.String&nbsp;key,
                          <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client">SharepointClientContext</A>&nbsp;sharepointClientContext)</PRE>
<DL>
<DD>Lookup a WebState by its key.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>key</CODE> - primary key
<DT><B>Returns:</B><DD>object handle, or null if none found</DL>
</DD>
</DL>
<HR>

<A NAME="getStateXML()"><!-- --></A><H3>
getStateXML</H3>
<PRE>
public java.lang.String <B>getStateXML</B>()
                             throws <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></PRE>
<DL>
<DD>Return an XML string representing the current state. Since our state
 is comprised almost entirely of the state of the StatefulObjects
 (i.e. ListState), this is largely done by calling an
 analogous method on those classes. Here is an example (note that
 the only state that belongs to GlobalState itself if the "current"
 object for each dependent class).  Consult ListState for details on
 its XML representation.
 (we have to use &lt; and &gt; here so the javadocs will come out right.)
<pre>
        &lt;?xml version="1.0" encoding="UTF-8"?&gt;
        &lt;state&gt;
          &lt;current id="foo" type="ListState"/&gt;
          &lt;ListState id="bar"&gt;
            &lt;lastMod&gt;20070420T154348.133-0700&lt;/lastMod&gt;
            &lt;URL/&gt;
           &lt;lastDocCrawled&gt;
              &lt;document id="id2"&gt;
                &lt;lastMod&gt;20070420T154348.133-0700&lt;/lastMod&gt;
                &lt;url&gt;url2&lt;/url&gt;
              &lt;/document&gt;
            &lt;/lastDocCrawled&gt;
          &lt;/ListState&gt;
          &lt;ListState id="foo"&gt;
            &lt;lastMod&gt;20070420T154348.133-0700&lt;/lastMod&gt;
            &lt;URL/&gt;
            &lt;lastDocCrawled&gt;
              &lt;document id="id1"&gt;
                &lt;lastMod&gt;20070420T154348.133-0700&lt;/lastMod&gt;
                &lt;url&gt;url1&lt;/url&gt;
             &lt;/document&gt;
            &lt;/lastDocCrawled&gt;
            &lt;crawlQueue&gt;
              &lt;document id="id3"&gt;
                &lt;lastMod&gt;20070420T154348.133-0700&lt;/lastMod&gt;
                &lt;url&gt;url3&lt;/url&gt;
              &lt;/document&gt;
              &lt;document id="id4"&gt;
               &lt;lastMod&gt;20070420T154348.133-0700&lt;/lastMod&gt;
                &lt;url&gt;url4&lt;/url&gt;
              &lt;/document&gt;
            &lt;/crawlQueue&gt;
          &lt;/ListState&gt;
        &lt;/state&gt;
</pre>
<P>
<DD><DL>

<DT><B>Returns:</B><DD>XML string
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="saveState()"><!-- --></A><H3>
saveState</H3>
<PRE>
public void <B>saveState</B>()
               throws <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></PRE>
<DL>
<DD>Creates an XML representation of our state, and saves it, using the
 PrefsStore mechanism.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="loadStateXML(java.io.File)"><!-- --></A><H3>
loadStateXML</H3>
<PRE>
private void <B>loadStateXML</B>(java.io.File&nbsp;fileState)
                   throws <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></PRE>
<DL>
<DD>Load from XML.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fileState</CODE> - - file name for the state file, which has already been
     checked as to its existence.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="loadState()"><!-- --></A><H3>
loadState</H3>
<PRE>
public void <B>loadState</B>()
               throws <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></PRE>
<DL>
<DD>Load persistent state from our XML state.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></CODE> - if the XML file can't be found, or is
     invalid in any way.</DL>
</DD>
</DL>
<HR>

<A NAME="setCurrentWeb(com.google.enterprise.connector.sharepoint.state.WebState)"><!-- --></A><H3>
setCurrentWeb</H3>
<PRE>
public void <B>setCurrentWeb</B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&nbsp;inCurrentWeb)</PRE>
<DL>
<DD>Set the given List as "current"
 This will be remembered in the XML state.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>inCurrentWeb</CODE> - ListState</DL>
</DD>
</DL>
<HR>

<A NAME="getCurrentWeb()"><!-- --></A><H3>
getCurrentWeb</H3>
<PRE>
public <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A> <B>getCurrentWeb</B>()</PRE>
<DL>
<DD>Get the current ListState.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the current object, or null if none</DL>
</DD>
</DL>
<HR>

<A NAME="updateList(com.google.enterprise.connector.sharepoint.state.WebState)"><!-- --></A><H3>
updateList</H3>
<PRE>
public void <B>updateList</B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&nbsp;state)</PRE>
<DL>
<DD>For a single StatefulObject, update the two
 data structures (url -> obj and time -> obj) and mark
 it "Existing" (if between startRecrawl() and endRecrawl()).
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>state</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="getStateFileLocation()"><!-- --></A><H3>
getStateFileLocation</H3>
<PRE>
private java.io.File <B>getStateFileLocation</B>()</PRE>
<DL>
<DD>Return the location for our state file. If we were given a 
 googleConnectorWorkDir (the expected case), use that; else use the
 current working directory and log an error.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>File</DL>
</DD>
</DL>
<HR>

<A NAME="getAllWebStateSet()"><!-- --></A><H3>
getAllWebStateSet</H3>
<PRE>
public java.util.SortedSet <B>getAllWebStateSet</B>()</PRE>
<DL>
<DD><DL>

<DT><B>Returns:</B><DD>the list sorted list of web states</DL>
</DD>
</DL>
<HR>

<A NAME="getLastCrawledListID()"><!-- --></A><H3>
getLastCrawledListID</H3>
<PRE>
public java.lang.String <B>getLastCrawledListID</B>()</PRE>
<DL>
<DD><DL>

<DT><B>Returns:</B><DD>the last crawled list ID</DL>
</DD>
</DL>
<HR>

<A NAME="setLastCrawledListID(java.lang.String)"><!-- --></A><H3>
setLastCrawledListID</H3>
<PRE>
public void <B>setLastCrawledListID</B>(java.lang.String&nbsp;inLastCrawledListState)</PRE>
<DL>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>inLastCrawledListState</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="getLastCrawledWebID()"><!-- --></A><H3>
getLastCrawledWebID</H3>
<PRE>
public java.lang.String <B>getLastCrawledWebID</B>()</PRE>
<DL>
<DD><DL>

<DT><B>Returns:</B><DD>the last crawled web ID</DL>
</DD>
</DL>
<HR>

<A NAME="setLastCrawledWebID(java.lang.String)"><!-- --></A><H3>
setLastCrawledWebID</H3>
<PRE>
public void <B>setLastCrawledWebID</B>(java.lang.String&nbsp;inLastCrawledWebID)</PRE>
<DL>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>inLastCrawledWebID</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="isBFullReCrawl()"><!-- --></A><H3>
isBFullReCrawl</H3>
<PRE>
public boolean <B>isBFullReCrawl</B>()</PRE>
<DL>
<DD><DL>

<DT><B>Returns:</B><DD>the boolean balue depicting whther a complete crawl cycle has completed</DL>
</DD>
</DL>
<HR>

<A NAME="setBFullReCrawl(boolean)"><!-- --></A><H3>
setBFullReCrawl</H3>
<PRE>
public void <B>setBFullReCrawl</B>(boolean&nbsp;fullReCrawl)</PRE>
<DL>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fullReCrawl</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="getFeedType()"><!-- --></A><H3>
getFeedType</H3>
<PRE>
public java.lang.String <B>getFeedType</B>()</PRE>
<DL>
<DD><DL>

<DT><B>Returns:</B><DD>the feedType</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/ListState.html" title="class in com.google.enterprise.connector.sharepoint.state"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../../index.html?com/google/enterprise/connector/sharepoint/state/GlobalState.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="GlobalState.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright 2007 Google Inc.
</BODY>
</HTML>
