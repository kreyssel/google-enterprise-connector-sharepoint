<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_05) on Mon Jun 22 16:46:09 IST 2009 -->
<TITLE>
SharepointClient (Google Enterprise Connector for Microsoft SharePoint 2003,2007 (Version 2.0.0_Build9))
</TITLE>

<META NAME="keywords" CONTENT="com.google.enterprise.connector.sharepoint.client.SharepointClient class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="SharepointClient (Google Enterprise Connector for Microsoft SharePoint 2003,2007 (Version 2.0.0_Build9))";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/Attribute.html" title="class in com.google.enterprise.connector.sharepoint.client"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../../index.html?com/google/enterprise/connector/sharepoint/client/SharepointClient.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SharepointClient.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.google.enterprise.connector.sharepoint.client</FONT>
<BR>
Class SharepointClient</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../../../resources/inherit.gif" ALT="extended by "><B>com.google.enterprise.connector.sharepoint.client.SharepointClient</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>SharepointClient</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
This class provides a layer of abstraction between the SharePoint Traversal Manager and the java clients 
 for making web service calls. Every time traversal is started/resumed, connector goes through this layer. 
 This class has the inteliigence to know which web service should be consulted for some purpose. 
 This class has all the methods needed to get documents and sites from the sharepoint server.
<P>

<P>
<DL>
<DT><B>Author:</B></DT>
  <DD>nitendra_thakur</DD>
</DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClient.html#doCrawl">doCrawl</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.util.logging.Logger</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClient.html#LOGGER">LOGGER</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClient.html#nDocuments">nDocuments</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client">SharepointClientContext</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClient.html#sharepointClientContext">sharepointClientContext</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClient.html#SharepointClient(com.google.enterprise.connector.sharepoint.client.SharepointClientContext)">SharepointClient</A></B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client">SharepointClientContext</A>&nbsp;inSharepointClientContext)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClient.html#discoverExtraWebs(java.util.Set, java.lang.String)">discoverExtraWebs</A></B>(java.util.Set&lt;java.lang.String&gt;&nbsp;allSites,
                  java.lang.String&nbsp;spType)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discover extra webs viz, MySites, Personal Sites, GSSiteDiscover discovered sites etc and store them into allSites.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SPDocumentList.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SPDocumentList</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClient.html#handleCrawlQueueForList(com.google.enterprise.connector.sharepoint.state.GlobalState, com.google.enterprise.connector.sharepoint.state.WebState, com.google.enterprise.connector.sharepoint.state.ListState)">handleCrawlQueueForList</A></B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html" title="class in com.google.enterprise.connector.sharepoint.state">GlobalState</A>&nbsp;globalState,
                        <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&nbsp;web,
                        <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/ListState.html" title="class in com.google.enterprise.connector.sharepoint.state">ListState</A>&nbsp;list)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For a single ListState, handle its crawl queue (if any).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClient.html#isDoCrawl()">isDoCrawl</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClient.html#processAlerts(com.google.enterprise.connector.sharepoint.state.WebState, com.google.enterprise.connector.sharepoint.client.SharepointClientContext)">processAlerts</A></B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&nbsp;webState,
              <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client">SharepointClientContext</A>&nbsp;tempCtx)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Makes a call to WSClient layer to get the alerts for a site and updates the global state.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SPDocumentList.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SPDocumentList</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClient.html#traverse(com.google.enterprise.connector.sharepoint.state.GlobalState, com.google.enterprise.connector.sharepoint.state.WebState, int)">traverse</A></B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html" title="class in com.google.enterprise.connector.sharepoint.state">GlobalState</A>&nbsp;globalState,
         <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&nbsp;webState,
         int&nbsp;sizeHint)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calls DocsFromDocLibPerSite for all the sites under the current site.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClient.html#updateGlobalState(com.google.enterprise.connector.sharepoint.state.GlobalState)">updateGlobalState</A></B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html" title="class in com.google.enterprise.connector.sharepoint.state">GlobalState</A>&nbsp;globalState)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discovers the child sites, MySites, Personal Sites, Sites discovered by GSSite discovery.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClient.html#updateGlobalState(com.google.enterprise.connector.sharepoint.state.GlobalState, java.util.Set)">updateGlobalState</A></B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html" title="class in com.google.enterprise.connector.sharepoint.state">GlobalState</A>&nbsp;globalState,
                  java.util.Set&nbsp;allSites)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iterate through fresh list of webs in allSites and update GS (i.e.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClient.html#updateGlobalState(com.google.enterprise.connector.sharepoint.state.GlobalState, java.lang.String)">updateGlobalState</A></B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html" title="class in com.google.enterprise.connector.sharepoint.state">GlobalState</A>&nbsp;globalState,
                  java.lang.String&nbsp;url)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check for a web if it exists in the global state.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClient.html#updateWebStateFromSite(com.google.enterprise.connector.sharepoint.client.SharepointClientContext, com.google.enterprise.connector.sharepoint.state.WebState, java.lang.String, java.util.Set)">updateWebStateFromSite</A></B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client">SharepointClientContext</A>&nbsp;tempCtx,
                       <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&nbsp;webState,
                       java.lang.String&nbsp;nextLastListID,
                       java.util.Set&lt;java.lang.String&gt;&nbsp;allWebs)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets all the docs from the SPDocument Library and all the items and their 
 attachments from Generic Lists and Issues in sharepoint under a given
 site.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="LOGGER"><!-- --></A><H3>
LOGGER</H3>
<PRE>
private final java.util.logging.Logger <B>LOGGER</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="sharepointClientContext"><!-- --></A><H3>
sharepointClientContext</H3>
<PRE>
private <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client">SharepointClientContext</A> <B>sharepointClientContext</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="nDocuments"><!-- --></A><H3>
nDocuments</H3>
<PRE>
private int <B>nDocuments</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="doCrawl"><!-- --></A><H3>
doCrawl</H3>
<PRE>
private boolean <B>doCrawl</B></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="SharepointClient(com.google.enterprise.connector.sharepoint.client.SharepointClientContext)"><!-- --></A><H3>
SharepointClient</H3>
<PRE>
public <B>SharepointClient</B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client">SharepointClientContext</A>&nbsp;inSharepointClientContext)
                 throws <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></PRE>
<DL>
<DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></CODE></DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="handleCrawlQueueForList(com.google.enterprise.connector.sharepoint.state.GlobalState, com.google.enterprise.connector.sharepoint.state.WebState, com.google.enterprise.connector.sharepoint.state.ListState)"><!-- --></A><H3>
handleCrawlQueueForList</H3>
<PRE>
private <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SPDocumentList.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SPDocumentList</A> <B>handleCrawlQueueForList</B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html" title="class in com.google.enterprise.connector.sharepoint.state">GlobalState</A>&nbsp;globalState,
                                               <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&nbsp;web,
                                               <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/ListState.html" title="class in com.google.enterprise.connector.sharepoint.state">ListState</A>&nbsp;list)</PRE>
<DL>
<DD>For a single ListState, handle its crawl queue (if any). This means add it
 to the ResultSet which we give back to the Connector Manager.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>globalState</CODE> - The recent snapshot of the whole in-memory state file.<DD><CODE>web</CODE> - Represets the current web state<DD><CODE>list</CODE> - Represents the current list state
<DT><B>Returns:</B><DD><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SPDocumentList.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl"><CODE>SPDocumentList</CODE></A> conatining the crawled documents.</DL>
</DD>
</DL>
<HR>

<A NAME="traverse(com.google.enterprise.connector.sharepoint.state.GlobalState, com.google.enterprise.connector.sharepoint.state.WebState, int)"><!-- --></A><H3>
traverse</H3>
<PRE>
public <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SPDocumentList.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SPDocumentList</A> <B>traverse</B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html" title="class in com.google.enterprise.connector.sharepoint.state">GlobalState</A>&nbsp;globalState,
                               <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&nbsp;webState,
                               int&nbsp;sizeHint)</PRE>
<DL>
<DD>Calls DocsFromDocLibPerSite for all the sites under the current site. It's
 possible that we're resuming traversal, because of batch hints. In this
 case, we rely on GlobalState's notion of "current". Each time we visit a
 List (whether or not it has docs to crawl), we mark it "current." On a
 subsequent call to traverse(), we start AFTER the current, if there is one.
 One might wonder why we don't just delete the crawl queue when done. The
 answer is, we don't consider it "done" until we're notified via the
 Connector Manager's call to checkpoint(). Until that time, it's possible
 we'd have to traverse() it again.
<P>
<DD><DL>

<DT><B>Returns:</B><DD><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SPDocumentList.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl"><CODE>SPDocumentList</CODE></A> containing crawled <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SPDocument.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl"><CODE>SPDocument</CODE></A>.</DL>
</DD>
</DL>
<HR>

<A NAME="discoverExtraWebs(java.util.Set, java.lang.String)"><!-- --></A><H3>
discoverExtraWebs</H3>
<PRE>
private void <B>discoverExtraWebs</B>(java.util.Set&lt;java.lang.String&gt;&nbsp;allSites,
                               java.lang.String&nbsp;spType)
                        throws <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></PRE>
<DL>
<DD>Discover extra webs viz, MySites, Personal Sites, GSSiteDiscover discovered sites etc and store them into allSites.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>allSites</CODE> - <DD><CODE>spType</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="updateGlobalState(com.google.enterprise.connector.sharepoint.state.GlobalState, java.util.Set)"><!-- --></A><H3>
updateGlobalState</H3>
<PRE>
private boolean <B>updateGlobalState</B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html" title="class in com.google.enterprise.connector.sharepoint.state">GlobalState</A>&nbsp;globalState,
                                  java.util.Set&nbsp;allSites)</PRE>
<DL>
<DD>iterate through fresh list of webs in allSites and update GS (i.e. add WS if not there already)
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>globalState</CODE> - <DD><CODE>allSites</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="updateGlobalState(com.google.enterprise.connector.sharepoint.state.GlobalState, java.lang.String)"><!-- --></A><H3>
updateGlobalState</H3>
<PRE>
private <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A> <B>updateGlobalState</B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html" title="class in com.google.enterprise.connector.sharepoint.state">GlobalState</A>&nbsp;globalState,
                                   java.lang.String&nbsp;url)</PRE>
<DL>
<DD>Check for a web if it exists in the global state. If not, then creates a corresponding web state and adds it into the global state.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>globalState</CODE> - <DD><CODE>url</CODE> - 
<DT><B>Returns:</B><DD><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state"><CODE>WebState</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="updateGlobalState(com.google.enterprise.connector.sharepoint.state.GlobalState)"><!-- --></A><H3>
updateGlobalState</H3>
<PRE>
public void <B>updateGlobalState</B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/GlobalState.html" title="class in com.google.enterprise.connector.sharepoint.state">GlobalState</A>&nbsp;globalState)
                       throws <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></PRE>
<DL>
<DD>Discovers the child sites, MySites, Personal Sites, Sites discovered by GSSite discovery.
 State information is updated as and when the webs are discovered.
 A further call to updateWebStateFromSite is made to discover the lists/libraries and the documenst from each discovered web.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>globalState</CODE> - The recent state information
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="isDoCrawl()"><!-- --></A><H3>
isDoCrawl</H3>
<PRE>
public boolean <B>isDoCrawl</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="processAlerts(com.google.enterprise.connector.sharepoint.state.WebState, com.google.enterprise.connector.sharepoint.client.SharepointClientContext)"><!-- --></A><H3>
processAlerts</H3>
<PRE>
private void <B>processAlerts</B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&nbsp;webState,
                           <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client">SharepointClientContext</A>&nbsp;tempCtx)</PRE>
<DL>
<DD>Makes a call to WSClient layer to get the alerts for a site and updates the global state.
 Alerts, in SharePoint are created at web level. Though, in the state file that connector maintains a SPDoc can only be inside a ListState.
        Hence, we need to create a dummy list here. ListID = siteName_Alerts: to make it unique for alerts and LastMod: current time
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>webState</CODE> - <DD><CODE>tempCtx</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="updateWebStateFromSite(com.google.enterprise.connector.sharepoint.client.SharepointClientContext, com.google.enterprise.connector.sharepoint.state.WebState, java.lang.String, java.util.Set)"><!-- --></A><H3>
updateWebStateFromSite</H3>
<PRE>
private void <B>updateWebStateFromSite</B>(<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client">SharepointClientContext</A>&nbsp;tempCtx,
                                    <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/state/WebState.html" title="class in com.google.enterprise.connector.sharepoint.state">WebState</A>&nbsp;webState,
                                    java.lang.String&nbsp;nextLastListID,
                                    java.util.Set&lt;java.lang.String&gt;&nbsp;allWebs)
                             throws <A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></PRE>
<DL>
<DD>Gets all the docs from the SPDocument Library and all the items and their 
 attachments from Generic Lists and Issues in sharepoint under a given
 site. It first calls SiteData web service to get all the Lists. And then
 calls Lists web service to get the list items for the lists which are of
 the type SPDocument Library, Generic Lists or Issues.
 For attachments in Generic List items and Issues, it calls Lists 
 web service to get attachments for these list items.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>tempCtx</CODE> - Current connector context<DD><CODE>webState</CODE> - The state information of the web which is ti be crawled for documents<DD><CODE>nextLastListID</CODE> - Last List traversed. If the current web contains this list, the traversal will start from here.<DD><CODE>allWebs</CODE> - Contains all the webs that has been doscovered from link sites/Site directory.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../../com/google/enterprise/connector/sharepoint/spiimpl/SharepointException.html" title="class in com.google.enterprise.connector.sharepoint.spiimpl">SharepointException</A></CODE></DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/Attribute.html" title="class in com.google.enterprise.connector.sharepoint.client"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../../com/google/enterprise/connector/sharepoint/client/SharepointClientContext.html" title="class in com.google.enterprise.connector.sharepoint.client"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../../index.html?com/google/enterprise/connector/sharepoint/client/SharepointClient.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SharepointClient.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright 2007 Google Inc.
</BODY>
</HTML>
